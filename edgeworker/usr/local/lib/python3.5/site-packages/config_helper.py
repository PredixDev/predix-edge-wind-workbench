import os.path
from shutil import copyfile

#Handle config files for apps and site management
#The app config files are stored in /opt/microservice
#The site config files are store in /opt/site_config
#Site config is expected to be volumned from host

def get_config_path(filename):
    app_dir = "/opt/microservice"
    site_dir = "/opt/site_config"
    app_config_file = os.path.join(app_dir, filename)
    site_file =  os.path.join(site_dir, filename)

    if os.path.isfile(site_file):
        return site_file
    if not os.path.exists(site_dir):
        try:
            os.makedirs(site_dir)
        except:
            print("INFO: could not make site directory", site_dir)
            print("INFO: use default config file", app_config_file)
            return app_config_file

    if os.path.isfile(app_config_file):
        try:
            copyfile(app_config_file, site_file)
            return site_file
        except:
            print("INFO: could not copy {0} to {1}".format(app_config_file, site_file))
            print("INFO: use default config file", app_config_file)
            return app_config_file
    else:
        print("INFO: could not locate default config file ", app_config_file)
        return None

